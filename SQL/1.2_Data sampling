--Выборка всех данных из таблицы

--Для того чтобы отобрать все данные из таблицы используется SQL запрос следующей структуры:

--ключевое слово SELECT;
--символ « *» ;
--ключевое слово FROM;
--имя таблицы.
--Результатом является таблица, в которую включены все строки и столбцы указанной в запросе таблицы.

--Пример

--Выбрать все записи таблицы book .

--Запрос:

SELECT * FROM book;

--Задание
--Вывести информацию о всех книгах, хранящихся на складе.

--Для этого:

--Напишите SQL запрос в окне кода;
--Отправьте на проверку (кнопка  Отправить);
--Если запрос работает неверно, исправьте его и снова отправьте на проверку.
--Важно! В окне кода можно использовать комментарии для сохранения разных вариантов запросов или пояснений.
--Комментарии заключаются в /* и */

--Решение:

SELECT * FROM book

--------------------------------------------------------------------------------------------------------------------

--Выборка отдельных столбцов

--Для того чтобы отобрать данные из определенных столбцов таблицы используется SQL запрос следующей структуры:

--ключевое слово SELECT ;
--список столбцов таблицы через запятую;
--ключевое слово FROM ;
--имя таблицы.
--Результатом является таблица, в которую включены все данные из указанных после SELECT столбцов исходной таблицы.

--Пример

--Выбрать названия книг и их количества из таблицы book .

--Запрос:

SELECT title, amount FROM book;

--Задание
--Выбрать авторов, название книг и их цену из таблицы book.

--Результат:

--+------------------+-----------------------+--------+
--| author           | title                 | price  |
--+------------------+-----------------------+--------+
--| Булгаков М.А.    | Мастер и Маргарита    | 670.99 |
--| Булгаков М.А.    | Белая гвардия         | 540.50 |
--| Достоевский Ф.М. | Идиот                 | 460.00 |
--| Достоевский Ф.М. | Братья Карамазовы     | 799.01 |
--| Есенин С.А.      | Стихотворения и поэмы | 650.00 |
--+------------------+-----------------------+--------+
--Affected rows: 5

SELECT author, title, price FROM book;

--------------------------------------------------------------------------------------------------------------------

--Выборка новых столбцов и присвоение им новых имен

--Выборка новых столбцов и присвоение им новых имен
--Для того чтобы отобрать данные из определенных столбцов таблицы и одновременно задать столбцам новые имена используется
-- SQL запрос следующей структуры:
--
--ключевое слово SELECT ;
--имя столбца;
--ключевое слово AS ;
--новое название столбца (можно русскими буквами), но это должно быть одно слово, если название состоит из двух слов
-- – соединяйте их подчеркиванием, например, Количество_книг ;
--запятая;
--имя столбца;
--...
--ключевое слово FROM ;
--имя таблицы.
--В одном запросе можно использовать и имена столбцов из таблицы, и новые названия.

--Результатом является таблица, в которую включены все данные из указанных после SELECT столбцов исходной таблицы.
-- Каждому столбцу присваивается новое имя, заданное после AS, или столбец получает имя столбца исходной таблицы,
--  если AS отсутствует.

--Пример

--Выбрать все названия книг и их количества из таблицы book , для столбца title задать новое имя Название.

--Запрос:
SELECT title AS Название, amount
FROM book;

Результат:

--+-----------------------+--------+
--| Название              | amount |
--+-----------------------+--------+
--| Мастер и Маргарита    | 3      |
--| Белая гвардия         | 5      |
--| Идиот                 | 10     |
--| Братья Карамазовы     | 2      |
--| Стихотворения и поэмы | 15     |
--+-----------------------+--------+

--Задание
--Выбрать названия книг и авторов из таблицы book, для поля title задать имя(псевдоним) Название, для поля author –  Автор.

--Результат:

--+-----------------------+------------------+
--| Название              | Автор            |
--+-----------------------+------------------+
--| Мастер и Маргарита    | Булгаков М.А.    |
--| Белая гвардия         | Булгаков М.А.    |
--| Идиот                 | Достоевский Ф.М. |
--| Братья Карамазовы     | Достоевский Ф.М. |
--| Стихотворения и поэмы | Есенин С.А.      |
--+-----------------------+------------------+
--Affected rows: 5

SELECT title AS Название, author AS Автор
FROM book;

--------------------------------------------------------------------------------------------------------------------

--Выборка данных с созданием вычисляемого столбца

--С помощью SQL запросов можно осуществлять вычисления по каждой строке таблицы с помощью вычисляемого столбца.
-- Для него в списке полей после оператора SELECT указывается выражение и задается имя.

--Выражение может включать имена столбцов, константы, знаки операций, встроенные функции.

--Результатом является таблица, в которую включены все данные из указанных после SELECT столбцов, а также новый столбец,
-- в каждой строке которого вычисляется заданное выражение.

--Пример

--Вывести всю информацию о книгах, а также для каждой позиции посчитать ее стоимость (произведение цены на количество).
-- Вычисляемому столбцу дать имя total .

--Запрос:

SELECT title, author, price, amount,
     price * amount AS total
FROM book;

--Результат:

--+-----------------------+------------------+--------+--------+---------+
--| title                 | author           | price  | amount | total   |
--+-----------------------+------------------+--------+--------+---------+
--| Мастер и Маргарита    | Булгаков М.А.    | 670.99 | 3      | 2012.97 |
--| Белая гвардия         | Булгаков М.А.    | 540.50 | 5      | 2702.50 |
--| Идиот                 | Достоевский Ф.М. | 460.00 | 10     | 4600.00 |
--| Братья Карамазовы     | Достоевский Ф.М. | 799.01 | 2      | 1598.02 |
--| Стихотворения и поэмы | Есенин С.А.      | 650.00 | 15     | 9750.00 |
--+-----------------------+------------------+--------+--------+---------+

--Задание
--Для упаковки каждой книги требуется один лист бумаги, цена которого 1 рубль 65 копеек. Посчитать стоимость упаковки
-- для каждой книги (сколько денег потребуется, чтобы упаковать все экземпляры книги). В запросе вывести название книги,
--  ее количество и стоимость упаковки, последний столбец назвать pack.

--Результат:

--+-----------------------+--------+-------+
--| title                 | amount | pack  |
--+-----------------------+--------+-------+
--| Мастер и Маргарита    | 3      | 4.95  |
--| Белая гвардия         | 5      | 8.25  |
--| Идиот                 | 10     | 16.50 |
--| Братья Карамазовы     | 2      | 3.30  |
--| Стихотворения и поэмы | 15     | 24.75 |
--+-----------------------+--------+-------+
--Affected rows: 5

SELECT title, amount,
    amount * 1.65 AS pack
FROM book;

--------------------------------------------------------------------------------------------------------------------

--Выборка данных, вычисляемые столбцы, математические функции

--Функция	Описание	Пример
--CEILING(x)	возвращает наименьшее целое число, большее или равное x
--(округляет до целого числа в большую сторону)	CEILING(4.2)=5
--CEILING(-5.8)=-5
--ROUND(x, k)	округляет значение x до k знаков после запятой,
--если k не указано – x округляется до целого	ROUND(4.361)=4
--ROUND(5.86592,1)=5.9
--FLOOR(x)	возвращает наибольшее целое число, меньшее или равное x
--(округляет до  целого числа в меньшую сторону)	FLOOR(4.2)=4
--FLOOR(-5.8)=-6
--POWER(x, y)	возведение x в степень y	POWER(3,4)=81.0
--SQRT(x)	квадратный корень из x	SQRT(4)=2.0
--SQRT(2)=1.41...
--DEGREES(x)	конвертирует значение x из радиан в градусы	DEGREES(3) = 171.8...
--RADIANS(x)	конвертирует значение x из градусов в радианы	RADIANS(180)=3.14...
--ABS(x)	модуль числа x	ABS(-1) = 1
--ABS(1) = 1
--PI()	pi = 3.1415926...

--Пояснение.   Существуют разные способы округления чисел. В SQL реализовано математическое округление. Для округления
-- вещественного числа нужно в записи числа выбрать разряд в дробной части, до которого производится округление.
--  Цифра, записанная в выбранном разряде: не меняется, если следующая за ней справа цифра - 0, 1, 2, 3 или 4;
--  увеличивается на единицу, если следующая за ней справа цифра - 5,6,7,8 или 9.

--Пример

--Для каждой книги из таблицы book вычислим налог на добавленную стоимость (имя столбца tax) , который включен в цену
-- и составляет k = 18%,  а также цену книги (price_tax) без него. Формулы для вычисления:

--Эта формула НДС отвечает на вопрос "Какую сумму увеличили на 18%, чтобы получить текущее значение"

--Запрос:

--SELECT title, price,
--    (price*18/100)/(1+18/100) AS tax,
--    price/(1+18/100) AS price_tax
--FROM book;

--+-----------------------+--------+----------------+------------+
--| title                 | price  | tax            | price_tax  |
--+-----------------------+--------+----------------+------------+
--| Мастер и Маргарита    | 670.99 | 102.3544067797 | 568.635593 |
--| Белая гвардия         | 540.50 | 82.4491525424  | 458.050847 |
--| Идиот                 | 460.00 | 70.1694915254  | 389.830508 |
--| Братья Карамазовы     | 799.01 | 121.8828813559 | 677.127119 |
--| Стихотворения и поэмы | 650.00 | 99.1525423729  | 550.847458 |
--+-----------------------+--------+----------------+------------+

--Сумма налога и цена книги без налога – это деньги, поэтому количество знаков после запятой у этих чисел должно быть 2.
-- Следовательно необходимо округлить полученные значения.

--Запрос:

--SELECT title,
--    price,
--    ROUND((price*18/100)/(1+18/100),2) AS tax,
--    ROUND(price/(1+18/100),2) AS price_tax
--FROM book;

--Результат:

--+-----------------------+--------+--------+-----------+
--| title                 | price  | tax    | price_tax |
--+-----------------------+--------+--------+-----------+
--| Мастер и Маргарита    | 670.99 | 102.35 | 568.64    |
--| Белая гвардия         | 540.50 | 82.45  | 458.05    |
--| Идиот                 | 460.00 | 70.17  | 389.83    |
--| Братья Карамазовы     | 799.01 | 121.88 | 677.13    |
--| Стихотворения и поэмы | 650.00 | 99.15  | 550.85    |
--+-----------------------+--------+--------+-----------+

--Задание
--В конце года цену всех книг на складе пересчитывают – снижают ее на 30%. Написать SQL запрос, который из таблицы book
-- выбирает названия, авторов, количества и вычисляет новые цены книг. Столбец с новой ценой назвать new_price, цену
--  округлить до 2-х знаков после запятой.

--Результат:

--+-----------------------+------------------+--------+-----------+
--| title                 | author           | amount | new_price |
--+-----------------------+------------------+--------+-----------+
--| Мастер и Маргарита    | Булгаков М.А.    | 3      | 469.69    |
--| Белая гвардия         | Булгаков М.А.    | 5      | 378.35    |
--| Идиот                 | Достоевский Ф.М. | 10     | 322.00    |
--| Братья Карамазовы     | Достоевский Ф.М. | 2      | 559.31    |
--| Стихотворения и поэмы | Есенин С.А.      | 15     | 455.00    |
--+-----------------------+------------------+--------+-----------+

--Query result:
--+-----------------------+------------------+--------+-----------+
--| title                 | author           | amount | new_price |
--+-----------------------+------------------+--------+-----------+
--| Мастер и Маргарита    | Булгаков М.А.    | 3      | 469.69    |
--| Белая гвардия         | Булгаков М.А.    | 5      | 378.35    |
--| Идиот                 | Достоевский Ф.М. | 10     | 322.00    |
--| Братья Карамазовы     | Достоевский Ф.М. | 2      | 559.31    |
--| Стихотворения и поэмы | Есенин С.А.      | 15     | 455.00    |
--+-----------------------+------------------+--------+-----------+
--Affected rows: 5

SELECT title, author, amount,
	ROUND(price - price / 100 * 30, 2) AS new_price
FROM book;

--------------------------------------------------------------------------------------------------------------------

--Выборка данных, вычисляемые столбцы, логические функции

--В SQL реализована возможность заносить в поле значение в зависимости от условия. Для этого используется функция IF():

--IF(логическое_выражение, выражение_1, выражение_2)
--Функция вычисляет логическое_выражение, если оно истина – в поле заносится значение выражения_1, в противном случае –  значение выражения_2. Все три параметра IF() являются обязательными.

--Допускается использование вложенных функций, вместо выражения_1 или выражения_2 может стоять новая функция IF.

--Пример

--Для каждой книги из таблицы book установим скидку следующим образом: если количество книг меньше 4, то скидка будет составлять 50% от цены, в противном случае 30%.

--Запрос:

SELECT title, amount, price,
    IF(amount<4, price*0.5, price*0.7) AS sale
FROM book;

--Результат:

--+-----------------------+--------+--------+---------+
--| title                 | amount | price  | sale    |
--+-----------------------+--------+--------+---------+
--| Мастер и Маргарита    | 3      | 670.99 | 335.495 |
--| Белая гвардия         | 5      | 540.50 | 378.350 |
--| Идиот                 | 10     | 460.00 | 322.000 |
--| Братья Карамазовы     | 2      | 799.01 | 399.505 |
--| Стихотворения и поэмы | 15     | 650.00 | 455.000 |
--+-----------------------+--------+--------+---------+

--Цена по скидке должна отображаться с двумя знаками после запятой, добавим в запрос округление:

SELECT title, amount, price,
    ROUND(IF(amount<4, price*0.5, price*0.7),2) AS sale
FROM book;

--Результат:

--+-----------------------+--------+--------+--------+
--| title                 | amount | price  | sale   |
--+-----------------------+--------+--------+--------+
--| Мастер и Маргарита    | 3      | 670.99 | 335.50 |
--| Белая гвардия         | 5      | 540.50 | 378.35 |
--| Идиот                 | 10     | 460.00 | 322.00 |
--| Братья Карамазовы     | 2      | 799.01 | 399.51 |
--| Стихотворения и поэмы | 15     | 650.00 | 455.00 |
--+-----------------------+--------+--------+--------+

--Пример

--Усложним вычисление скидки в зависимости от количества книг. Если количество книг меньше 4 – то скидка 50%, меньше
-- 11 – 30%, в остальных случаях – 10%. И еще укажем какая именно скидка на каждую книгу.

--Запрос:

SELECT title, amount, price,
    ROUND(IF(amount < 4, price * 0.5, IF(amount < 11, price * 0.7, price * 0.9)), 2) AS sale,
    IF(amount < 4, 'скидка 50%', IF(amount < 11, 'скидка 30%', 'скидка 10%')) AS Ваша_скидка
FROM book;

--Результат:

--+-----------------------+--------+--------+--------+-------------+
--| title                 | amount | price  | sale   | Ваша_скидка |
--+-----------------------+--------+--------+--------+-------------+
--| Мастер и Маргарита    | 3      | 670.99 | 335.50 | скидка 50%  |
--| Белая гвардия         | 5      | 540.50 | 378.35 | скидка 30%  |
--| Идиот                 | 10     | 460.00 | 322.00 | скидка 30%  |
--| Братья Карамазовы     | 2      | 799.01 | 399.51 | скидка 50%  |
--| Стихотворения и поэмы | 15     | 650.00 | 585.00 | скидка 10%  |
--+-----------------------+--------+--------+--------+-------------+

--Задание
--При анализе продаж книг выяснилось, что наибольшей популярностью пользуются книги Михаила Булгакова,
-- на втором месте книги Сергея Есенина. Исходя из этого решили поднять цену книг Булгакова на 10%, а цену книг
--  Есенина - на 5%. Написать запрос, куда включить автора, название книги и новую цену, последний
--   столбец назвать new_price. Значение округлить до двух знаков после запятой.


SELECT author, title,
    ROUND(IF(author = 'Булгаков М.А.', price * 0.1 + price,
             IF(author = 'Есенин С.А.', price * 0.05 + price, price * 1)), 2) AS new_price
FROM book;

--------------------------------------------------------------------------------------------------------------------

--Выборка данных по условию

--С помощью запросов можно включать в итоговую выборку не все строки исходной таблицы, а только те, которые отвечают некоторому условию. Для этого после указания таблицы, откуда выбираются данные, задается ключевое слово WHERE и логическое выражение, от результата которого зависит будет ли включена строка в выборку или нет. Если условие – истина, то строка(запись)  включается в выборку, если ложь – нет.

--Логическое выражение может включать операторы сравнения (равно «=», не равно «<>», больше «>», меньше «<», больше или равно«>=», меньше или равно «<=») и выражения, допустимые в SQL.

--Пример

--Вывести название и цену тех книг, цены которых меньше 600 рублей.

--Запрос:

SELECT title, price
FROM book
WHERE price < 600;

--Результат:

--+---------------+--------+
--| title         | price  |
--+---------------+--------+
--| Белая гвардия | 540.50 |
--| Идиот         | 460.00 |
--+---------------+--------+

--Пример

--Вывести название, автора  и стоимость (цена умножить на количество) тех книг, стоимость которых больше 4000 рублей

--Запрос:

--SELECT title, author, price * amount AS total
--FROM book
--WHERE price * amount > 4000;

--Результат:

--+-----------------------+------------------+---------+
--| title                 | author           | total   |
--+-----------------------+------------------+---------+
--| Идиот                 | Достоевский Ф.М. | 4600.00 |
--| Стихотворения и поэмы | Есенин С.А.      | 9750.00 |
--+-----------------------+------------------+---------+

--Задание
--Вывести автора, название  и цены тех книг, количество которых меньше 10.

--Результат:

--+------------------+--------------------+--------+
--| author           | title              | price  |
--+------------------+--------------------+--------+
--| Булгаков М.А.    | Мастер и Маргарита | 670.99 |
--| Булгаков М.А.    | Белая гвардия      | 540.50 |
--| Достоевский Ф.М. | Братья Карамазовы  | 799.01 |
--+------------------+--------------------+--------+

--------------------------------------------------------------------------------------------------------------------

--Выборка данных по условию

--С помощью запросов можно включать в итоговую выборку не все строки исходной таблицы, а только те, которые
--отвечают некоторому условию. Для этого после указания таблицы, откуда выбираются данные, задается ключевое
--слово WHERE и логическое выражение, от результата которого зависит будет ли включена строка в выборку или
--нет. Если условие – истина, то строка(запись)  включается в выборку, если ложь – нет.

--Логическое выражение может включать операторы сравнения (равно «=», не равно «<>», больше «>», меньше «<»,
--больше или равно«>=», меньше или равно «<=») и выражения, допустимые в SQL.

--Пример

--Вывести название и цену тех книг, цены которых меньше 600 рублей.

--Запрос:

SELECT title, price
FROM book
WHERE price < 600;

--Результат:

--+---------------+--------+
--| title         | price  |
--+---------------+--------+
--| Белая гвардия | 540.50 |
--| Идиот         | 460.00 |
--+---------------+--------+

-- Пример

--Вывести название, автора  и стоимость (цена умножить на количество) тех книг, стоимость которых больше 4000 рублей

--Запрос:

SELECT title, author, price * amount AS total
FROM book
WHERE price * amount > 4000;

Результат:

--+-----------------------+------------------+---------+
--| title                 | author           | total   |
--+-----------------------+------------------+---------+
--| Идиот                 | Достоевский Ф.М. | 4600.00 |
--| Стихотворения и поэмы | Есенин С.А.      | 9750.00 |
--+-----------------------+------------------+---------+

--Задание
--Вывести автора, название  и цены тех книг, количество которых меньше 10.

--Результат:

--+------------------+--------------------+--------+
--| author           | title              | price  |
--+------------------+--------------------+--------+
--| Булгаков М.А.    | Мастер и Маргарита | 670.99 |
--| Булгаков М.А.    | Белая гвардия      | 540.50 |
--| Достоевский Ф.М. | Братья Карамазовы  | 799.01 |
--+------------------+--------------------+--------+

SELECT author, title, price
FROM book
WHERE amount < 10;

--------------------------------------------------------------------------------------------------------------------

--Выборка данных, логические операции

-- Логическое выражение после ключевого слова WHERE кроме операторов сравнения  и выражений может включать  логические операции (И «and», ИЛИ «or», НЕ «not») и круглые скобки, изменяющие приоритеты выполнения операций.

--Приоритеты операций:

--1. круглые скобки
--2. умножение  (*),  деление (/)
--3. сложение  (+), вычитание (-)
--4. операторы сравнения (=, >, <, >=, <=, <>)
--5. NOT
--6. AND
--7. OR

--Пример

--Вывести название, автора и цену тех книг, которые написал Булгаков, ценой больше 600 рублей

--Запрос:

--SELECT title, author, price
--FROM book
--WHERE price > 600 AND author = 'Булгаков М.А.';

--Результат:

--+--------------------+---------------+--------+
--| title              | author        | price  |
--+--------------------+---------------+--------+
--| Мастер и Маргарита | Булгаков М.А. | 670.99 |
--+--------------------+---------------+--------+

--Пример

--Вывести название, цену  тех книг, которые написал Булгаков или Есенин, ценой больше 600 рублей

--Запрос:

--SELECT title, author, price
--FROM book
--WHERE (author = 'Булгаков М.А.' OR author = 'Есенин С.А.') AND price > 600;
--Результат:

--+-----------------------+---------------+--------+
--| title                 | author        | price  |
--+-----------------------+---------------+--------+
--| Мастер и Маргарита    | Булгаков М.А. | 670.99 |
--| Стихотворения и поэмы | Есенин С.А.   | 650.00 |
--+-----------------------+---------------+--------+

--В данном запросе обязательно нужно поставить скобки, так как без них сначала вычисляется
--  author = 'Есенин С.А.' and price > 600, а потом уже выражение через or. Без скобок были бы отобраны все книги Булгакова и те книги Есенина, цена которых больше 600.

--Запрос:

--SELECT title, author, price
--FROM book
--WHERE author = 'Булгаков М.А.' OR author = 'Есенин С.А.' AND price > 600;
--Результат (сравните с предыдущим):

--+-----------------------+---------------+--------+
--| title                 | author        | price  |
--+-----------------------+---------------+--------+
--| Мастер и Маргарита    | Булгаков М.А. | 670.99 |
--| Белая гвардия         | Булгаков М.А. | 540.50 |
--| Стихотворения и поэмы | Есенин С.А.   | 650.00 |
--+-----------------------+---------------+--------+

--Задание

--Вывести название, автора,  цену  и количество всех книг, цена которых меньше 500 или больше 600,
-- а стоимость всех экземпляров этих книг больше или равна 5000.

-- Результат:

--+-----------------------+-------------+--------+--------+
--| title                 | author      | price  | amount |
--+-----------------------+-------------+--------+--------+
--| Стихотворения и поэмы | Есенин С.А. | 650.00 | 15     |
--+-----------------------+-------------+--------+--------+

SELECT title,author, price, amount
FROM book
WHERE (price < 500 OR price > 600) AND price * amount > 5000;

--------------------------------------------------------------------------------------------------------------------

--Выборка данных, операторы BETWEEN, IN

-- Логическое выражение после ключевого слова WHERE может включать операторы  BETWEEN и IN. Приоритет  у этих операторов такой же как у операторов сравнения, то есть они выполняются раньше, чем NOT, AND, OR.

--Оператор BETWEEN позволяет отобрать данные, относящиеся к некоторому интервалу, включая его границы.

--Пример

--Выбрать названия и количества тех книг, количество которых от 5 до 14 включительно.

--Запрос:

SELECT title, amount
FROM book
WHERE amount BETWEEN 5 AND 14;

--Результат:

--+---------------+--------+
--| title         | amount |
--+---------------+--------+
--| Белая гвардия | 5      |
--| Идиот         | 10     |
--+---------------+--------+

--Этот запрос можно реализовать по-другому, результат будет точно такой же.

SELECT title, amount
FROM book
WHERE amount >= 5 AND amount <=14;

--оператор  IN  позволяет выбрать данные, соответствующие значениям из списка.

--Пример

--Выбрать названия и цены книг, написанных Булгаковым или Достоевским.

--Запрос:

SELECT title, price
FROM book
WHERE author IN ('Булгаков М.А.', 'Достоевский Ф.М.');

--Результат:

--+--------------------+--------+
--| title              | price  |
--+--------------------+--------+
--| Мастер и Маргарита | 670.99 |
--| Белая гвардия      | 540.50 |
--| Идиот              | 460.00 |
--| Братья Карамазовы  | 799.01 |
--+--------------------+--------+

--Этот запрос можно реализовать по-другому, результат будет точно такой же.

--SELECT title, price
--FROM book
--WHERE author = 'Булгаков М.А.' OR author = 'Достоевский Ф.М.';

--Задание
--Вывести название и авторов тех книг, цены которых принадлежат интервалу от 540.50 до 800 (включая границы),
--  а количество или 2, или 3, или 5, или 7 .

--Результат:

--+--------------------+------------------+
--| title              | author           |
--+--------------------+------------------+
--| Мастер и Маргарита | Булгаков М.А.    |
--| Белая гвардия      | Булгаков М.А.    |
--| Братья Карамазовы  | Достоевский Ф.М. |
--+--------------------+------------------+

SELECT title, author
FROM book
WHERE price BETWEEN 540.50 AND 800 AND amount IN (2, 3, 5, 7);

--------------------------------------------------------------------------------------------------------------------

